<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Design Playground – Single Post</title>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,400;0,700;1,400&family=Source+Sans+3:ital,wght@0,400;0,600;0,700;0,800;1,400;1,600&family=Vollkorn:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600&display=swap"
			rel="stylesheet"
		/>
		<style>
			/* ==========================================================================
			   Design Playground Controls
			   ========================================================================== */
			* {
				box-sizing: border-box;
				margin: 0;
				padding: 0;
			}

			body {
				font-family: system-ui;
				background: #1a1a1a;
				color: #f0f0f0;
				overflow: hidden;
			}

			.container {
				display: grid;
				grid-template-columns: 320px 1fr;
				height: 100vh;
			}

			.controls {
				background: #2a2a2a;
				padding: 15px;
				overflow-y: auto;
				border-right: 1px solid #444;
				font-size: 0.85rem;
			}

			.controls h1 {
				font-size: 1.2rem;
				margin-bottom: 8px;
			}

			.controls h2 {
				font-size: 0.8rem;
				color: #aaa;
				text-transform: uppercase;
				margin: 18px 0 8px;
				border-bottom: 1px solid #444;
				padding-bottom: 4px;
			}

			.control {
				margin-bottom: 10px;
			}

			.control label {
				display: block;
				font-size: 0.75rem;
				color: #ccc;
				margin-bottom: 4px;
			}

			input[type="range"] {
				width: 100%;
				height: 4px;
			}

			input[type="number"] {
				width: 55px;
				padding: 3px;
				background: #1a1a1a;
				border: 1px solid #444;
				border-radius: 3px;
				color: #f0f0f0;
				font-size: 0.75rem;
			}

			input[type="color"] {
				width: 100%;
				height: 28px;
				border: none;
				cursor: pointer;
			}

			select {
				width: 100%;
				padding: 5px;
				background: #1a1a1a;
				border: 1px solid #444;
				border-radius: 3px;
				color: #f0f0f0;
				font-size: 0.75rem;
			}

			button {
				width: 100%;
				padding: 10px;
				margin-top: 15px;
				background: #8f1d14;
				color: #fff;
				border: none;
				border-radius: 4px;
				cursor: pointer;
				font-weight: 600;
				font-size: 0.8rem;
			}

			button:hover {
				background: #a52218;
			}

			/* ==========================================================================
			   Preview Area - Matches production index.css structure exactly
			   ========================================================================== */
			.preview {
				overflow-y: auto;
			}

			/* --- Production CSS from index.css starts here --- */

			.preview-inner {
				/* :root variables from index.css */
				--paper: #f6f0e8;
				--paper-2: #efe6db;
				--ink: #241425;
				--ink-2: #3a223a;
				--vermillion: #8f1d14;
				--rule: #241425;

				--font-body:
					"Vollkorn", "Noto Serif TC", "Source Han Serif TC",
					"Source Han Serif", ui-serif, Georgia, serif;
				--font-display:
					"Source Sans 3", "Source Sans Pro", "Noto Sans TC",
					"Source Han Sans TC", ui-sans-serif, system-ui, -apple-system,
					"Segoe UI", Roboto, Helvetica, Arial, sans-serif;
				--font-mn:
					"Gill Sans", "Gill Sans MT", "Gill Sans Nova", "Lato", "Noto Sans TC",
					"Source Han Sans TC", ui-sans-serif, system-ui, -apple-system,
					"Segoe UI", Roboto, Helvetica, Arial, sans-serif;

				--text-size: 1.2rem;
				--leading: 1.7;
				--measure: 70ch;

				/* Base styles from index.css html/body */
				background: var(--paper);
				color: var(--ink);
				font-family: var(--font-body);
				font-size: var(--text-size);
				line-height: var(--leading);
				font-weight: 500;
				min-height: 100%;
				padding: 2rem clamp(16px, 3vw, 28px);
			}

			/* main element styles from index.css */
			.preview-inner main {
				max-width: var(--measure);
				margin: 0 auto;
				padding: 2rem 0 4rem;
			}

			/* .post component from index.css lines 699-703 */
			.preview-inner .post {
				--post-measure: 65ch;
				--mn-width: 220px;
				--mn-gap: 2.5rem;
			}

			/* .post-header from index.css lines 705-708 */
			.preview-inner .post-header {
				max-width: var(--post-measure);
				margin-bottom: 2rem;
			}

			/* .post-title from index.css lines 710-716 */
			.preview-inner .post-title {
				font-family: var(--font-display);
				font-size: clamp(1.8rem, 4vw, 2.6rem);
				line-height: 1.15;
				margin: 0 0 0.5rem;
				font-weight: 700;
			}

			/* .post-metadata from index.css lines 718-728 */
			.preview-inner .post-metadata {
				list-style: none;
				padding: 0;
				margin: 0;
				display: flex;
				flex-wrap: wrap;
				gap: 0.5rem 1rem;
				font-family: var(--font-display);
				font-size: 0.85rem;
				color: var(--ink-2);
			}

			/* .post-tag from index.css lines 730-737 */
			.preview-inner .post-tag {
				text-decoration: none;
				color: var(--ink-2);
			}

			.preview-inner .post-tag:hover {
				color: var(--vermillion);
			}

			/* .post-body from index.css lines 739-743 */
			.preview-inner .post-body {
				font-size: 1.15rem;
				line-height: 1.75;
				max-width: var(--post-measure);
			}

			/* .post-body p from index.css lines 745-747 */
			.preview-inner .post-body p {
				margin: 0 0 1.2em;
			}

			/* .post-body blockquote from index.css lines 749-754 */
			.preview-inner .post-body blockquote {
				margin: 1.5em 0;
				padding-left: 1.2em;
				border-left: 3px solid var(--vermillion);
				color: var(--ink);
			}

			/* .post-body img from index.css lines 756-761 */
			.preview-inner .post-body img {
				max-width: 100%;
				height: auto;
				display: block;
				margin: 1.5em 0;
			}

			/* .post-body pre from index.css lines 763-770 */
			.preview-inner .post-body pre {
				font-size: 0.9em;
				line-height: 1.5;
				padding: 1em;
				overflow-x: auto;
				margin: 1.5em 0;
				border-radius: 4px;
			}

			/* hr styling */
			.preview-inner .post-body hr {
				border: none;
				border-top: 1px solid var(--rule);
				margin: 2em 0;
			}

			/* ==========================================================================
			   Margin Notes - from index.css lines 790-930
			   ========================================================================== */

			/* .mn-ref wrapper stays inline */
			.preview-inner .mn-ref {
				position: relative;
			}

			/* .mn-marker from index.css lines 804-814 */
			.preview-inner .mn-marker {
				font-size: 0.75em;
				vertical-align: super;
				line-height: 0;
				cursor: pointer;
				color: var(--vermillion);
				text-decoration: none;
				border: none;
				background: none;
				padding: 0 0.1em;
			}

			.preview-inner .mn-marker:hover,
			.preview-inner .mn-marker:focus {
				color: var(--ink);
			}

			/* .mn-note from index.css lines 838-843 */
			.preview-inner .mn-note {
				font-family: var(--font-mn);
				font-size: 0.82rem;
				line-height: 1.5;
				color: var(--ink-2);
			}

			/* Reset aside default styles */
			.preview-inner aside.mn-note {
				display: block;
				margin: 0;
			}

			.preview-inner .mn-note p {
				margin: 0 0 0.6em;
			}

			.preview-inner .mn-note p:last-child {
				margin-bottom: 0;
			}

			/* Mobile: Notes hidden, toggle on click - from index.css lines 866-886 */
			@media (max-width: 900px) {
				.preview-inner .mn-note {
					display: none;
					margin: 0.8em 0;
					padding: 0.8em 1em;
					background: color-mix(in srgb, var(--paper-2), transparent 50%);
					border-left: 3px solid var(--vermillion);
				}

				.preview-inner .mn-note.is-visible {
					display: block;
				}

				.preview-inner .mn-note:not([hidden]) {
					display: block;
				}

				.preview-inner .mn-marker[aria-expanded="true"] {
					color: var(--ink);
				}
			}

			/* Desktop: Notes in margin column - from index.css lines 888-930 */
			@media (min-width: 901px) {
				/* Widen the main area to make room for margin */
				.preview-inner main > .post {
					max-width: calc(
						var(--post-measure) + var(--mn-width) + var(--mn-gap)
					);
				}

				/* Post body is the positioning context for margin notes */
				.preview-inner .post-body {
					position: relative;
					max-width: var(--post-measure);
				}

				/* Notes are positioned absolutely in the margin */
				.preview-inner .mn-note {
					position: absolute;
					left: calc(100% + var(--mn-gap));
					width: var(--mn-width);
					/* top is set by JavaScript to align with marker */
				}

				/* No hover needed on desktop - notes are always visible */
				.preview-inner .mn-marker {
					cursor: default;
				}
			}

			/* Hide margin notes toggle */
			.preview-inner.playground-no-notes .mn-note,
			.preview-inner.playground-no-notes .mn-marker {
				display: none;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="controls">
				<h1>Design Playground</h1>
				<p style="color: #999; margin-bottom: 12px; font-size: 0.75rem">
					Single-post template tuning.<br />
					Values match production index.css exactly.
				</p>

				<h2>Colors</h2>
				<div class="control">
					<label>--paper</label>
					<input type="color" id="paper" value="#f6f0e8" />
				</div>
				<div class="control">
					<label>--paper-2</label>
					<input type="color" id="paper2" value="#efe6db" />
				</div>
				<div class="control">
					<label>--ink</label>
					<input type="color" id="ink" value="#241425" />
				</div>
				<div class="control">
					<label>--ink-2</label>
					<input type="color" id="ink2" value="#3a223a" />
				</div>
				<div class="control">
					<label>--vermillion</label>
					<input type="color" id="vermillion" value="#8f1d14" />
				</div>
				<div class="control">
					<label>--rule</label>
					<input type="color" id="rule" value="#241425" />
				</div>

				<h2>Base Typography (html/body)</h2>
				<div class="control">
					<label>--text-size: <span id="textSizeVal">1.2rem</span></label>
					<input
						type="range"
						id="textSize"
						min="0.9"
						max="1.5"
						step="0.05"
						value="1.2"
					/>
				</div>
				<div class="control">
					<label>--leading: <span id="leadingVal">1.7</span></label>
					<input
						type="range"
						id="leading"
						min="1.3"
						max="2.2"
						step="0.05"
						value="1.7"
					/>
				</div>
				<div class="control">
					<label>body font-weight: <span id="bodyWeightVal">500</span></label>
					<input
						type="range"
						id="bodyWeight"
						min="400"
						max="700"
						step="100"
						value="500"
					/>
				</div>

				<h2>Post Body (.post-body)</h2>
				<div class="control">
					<label>font-size: <span id="postBodySizeVal">1.15rem</span></label>
					<input
						type="range"
						id="postBodySize"
						min="0.9"
						max="1.5"
						step="0.05"
						value="1.15"
					/>
				</div>
				<div class="control">
					<label>line-height: <span id="postBodyLeadingVal">1.75</span></label>
					<input
						type="range"
						id="postBodyLeading"
						min="1.4"
						max="2.2"
						step="0.05"
						value="1.75"
					/>
				</div>

				<h2>Post Title (.post-title)</h2>
				<div class="control">
					<label>font-size max: <span id="titleSizeVal">2.6rem</span></label>
					<input
						type="range"
						id="titleSize"
						min="1.8"
						max="3.5"
						step="0.1"
						value="2.6"
					/>
				</div>
				<div class="control">
					<label>line-height: <span id="titleLeadingVal">1.15</span></label>
					<input
						type="range"
						id="titleLeading"
						min="1.0"
						max="1.5"
						step="0.05"
						value="1.15"
					/>
				</div>
				<div class="control">
					<label>font-weight: <span id="titleWeightVal">700</span></label>
					<input
						type="range"
						id="titleWeight"
						min="400"
						max="900"
						step="100"
						value="700"
					/>
				</div>

				<h2>Margin Notes (.mn-note)</h2>
				<div class="control">
					<label>font-size: <span id="mnSizeVal">0.82rem</span></label>
					<input
						type="range"
						id="mnSize"
						min="0.7"
						max="1.0"
						step="0.02"
						value="0.82"
					/>
				</div>
				<div class="control">
					<label>line-height: <span id="mnLeadingVal">1.5</span></label>
					<input
						type="range"
						id="mnLeading"
						min="1.2"
						max="1.8"
						step="0.05"
						value="1.5"
					/>
				</div>

				<h2>Layout (.post variables)</h2>
				<div class="control">
					<label>--post-measure: <span id="postMeasureVal">65ch</span></label>
					<input
						type="range"
						id="postMeasure"
						min="45"
						max="80"
						step="1"
						value="65"
					/>
				</div>
				<div class="control">
					<label>--mn-width: <span id="mnWidthVal">220px</span></label>
					<input
						type="range"
						id="mnWidth"
						min="150"
						max="320"
						step="10"
						value="220"
					/>
				</div>
				<div class="control">
					<label>--mn-gap: <span id="mnGapVal">2.5rem</span></label>
					<input
						type="range"
						id="mnGap"
						min="1"
						max="5"
						step="0.25"
						value="2.5"
					/>
				</div>

				<h2>Global Layout</h2>
				<div class="control">
					<label>--measure: <span id="measureVal">70ch</span></label>
					<input
						type="range"
						id="measure"
						min="50"
						max="90"
						step="1"
						value="70"
					/>
				</div>

				<h2>Options</h2>
				<div class="control">
					<label
						><input type="checkbox" id="showMarginNotes" checked /> Show margin
						notes</label
					>
				</div>

				<button onclick="copyCSS()">Copy CSS Variables</button>
			</div>

			<div class="preview">
				<div class="preview-inner" id="preview">
					<main>
						<article class="post">
							<header class="post-header">
								<h1 class="post-title">The Naming of Cats, and an Offering</h1>
								<ul class="post-metadata">
									<li><time datetime="2023-07-18">July 18, 2023</time></li>
									<li><a href="#" class="post-tag">translations</a></li>
								</ul>
							</header>

							<div class="post-body">
								<p>
									<em
										>A "cat contract" 納貓兒契式 listing the cat's obligations:
										patrolling tirelessly, catching mice, leaving the numnums
										alone. From 銜蟬小錄 <i>Xianchan xiaolu</i>.</em
									>
								</p>

								<p>
									If you can read Classical Chinese, you can have a moderately
									good time looking in pre-20th century reference texts to see
									what they have for "cat."
								</p>

								<p>
									The late 16th-century <i>Bencao gangmu</i> 本草綱目 (<i
										>Materia Medica</i
									>) says "貓 CAT can be read as either <i>miao</i> or
									<i>mao</i>. They can say their own name!" The 17th-century
									<i>Zhengzitong</i> 正字通 (<i
										>Comprehensive Guide to Correct Graphs</i
									>) explains that cats are "of the baleful category" (陰類也).
									The entry in the 8th-century <i>Wujing wenzi</i> 五經文字 (<i
										>Simplex and Compound Graphs from the</i
									>
									Five Classics), presumably written by either a cat or a
									Buddhist, calls them "ferocious beasts" (猛獸), while the
									11th-century <i>Piya</i>'s 埤雅 (<i>Expansion to the</i> Erya)
									entry for the character 貓 continues the <i>Erya</i>'s proud
									tradition of unhelpful lexicography<sup
										class="mn-marker"
										data-mn-id="mn-1"
										aria-expanded="false"
										>※</sup
									>
									with the following:
								</p>

								<aside class="mn-note" id="mn-1" hidden>
									I'm not being fair to the 3rd c. BCE dudes who wrote the
									<i>Erya,</i> which is not really a dictionary so much as a
									collection of factoids about characters. Sometimes those
									factoids include definitions; sometimes, as here, they're
									punny little mnemonics about characters' pronunciation or
									structure.
								</aside>

								<blockquote lang="zh-Hant">
									鼠害苗，而貓能捕鼠，去苗之害，故貓字從苗
								</blockquote>

								<blockquote>
									Mice harm SPROUTS 苗 <i>miáo</i>, and CATS 貓 <i>māo</i> can
									catch mice, eliminating the harm to the sprouts. That's why
									the character for CAT has SPROUT in it.
								</blockquote>

								<p>
									For anybody wondering how they said <i>pspsps</i> in the Qing
									dynasty, Wang Chutong's 王初桐 1798 <i>Mao sheng</i> 貓乘 (<i
										>A Cavalcade of Cats</i
									>), the earliest collection of cat-related quotations and
									factoids I could find, has a section listing all the ways of
									calling a cat known to authoritative sources. <i>Mi</i>,
									variously written, is the clear consensus favorite, though the
									Yuan writer Bai Ting 白珽 suggests 汁汁, pronounced something
									like <i>ji-ji</i> at the time. (Wang comments that this
									"sounds like mice squeaking.")
								</p>

								<p>
									Sun Sunyi's 孫蓀意 adorably titled
									<i>Xianchan xiaolu</i> 銜蟬小錄 (preface dated 1799, when she
									was just 16)<sup
										class="mn-marker"
										data-mn-id="mn-2"
										aria-expanded="false"
										>※</sup
									>
									has eight fascicles' worth of feline-related quotations
									grouped under headings like "Origins," "Nomenclature," and
									"Tales of Karmic Retribution," as well as a pretty impressive
									selection of what the preceding thousand years had to offer in
									the way of cat-related poetry.
								</p>

								<aside class="mn-note" id="mn-2" hidden>
									Literally, "<i>Notes on Cicada-Nommers.</i>" "Cicada-nommer"
									(銜蟬 <i>xianchan</i>) was a conventional word for cats at
									least as far back as the Song.
								</aside>

								<p>
									Unfortunately it doesn't have what <i>I'm</i> looking for,
									which is a list of cat names.
								</p>

								<hr />

								<p>
									A while ago, Jennifer Feeley tweeted about trying to find an
									English name for a cat named 麻珠 "Mázhū" in a Xi Xi story she
									was translating. Pet names are among the few exceptions<sup
										class="mn-marker"
										data-mn-id="mn-3"
										aria-expanded="false"
										>※</sup
									>
									to the hard and fast rule that anyone who translates a
									personal name will not see Valhalla, but they present problems
									of their own.
								</p>

								<aside class="mn-note" id="mn-3" hidden>
									Off the top of my head, the exceptions are pet names,
									nicknames, pen names, screen names, and anything else intended
									primarily to be meaningful — the key words being "intended"
									and "primarily."
								</aside>

								<p>
									I've always loved Robin Flower's translation of "Pangur Bán,"
									a poem in Old Irish written in the margin of a manuscript by a
									bored 9th century monk:
								</p>

								<blockquote>
									<pre>
I and Pangur Bán, my cat,
'Tis a like task we are at:
Hunting mice is his delight,
Hunting words I sit all night.

Better far than praise of men
'Tis to sit with book and pen;
Pangur bears me no ill-will,
He too plies his simple skill.</pre
									>
								</blockquote>

								<p>
									For the author and his first readers, but not for us, the name
									"Pangur" would obviously have belonged to a cat, a problem
									Flower solved by adding "my cat" to the first line of his
									translation. He leaves <i>Bán</i> ("white") untranslated. Does
									it matter if a reader of Flower's English comes away knowing
									less than someone who reads the original?
								</p>

								<hr />

								<p>
									The <i>Xiang mao jing</i> 相貓經 (<i
										>Guide to Cat Physiognomy</i
									>), quoted extensively in Huang Han's 1852
									<i>Mao yuan</i> 貓苑 (<i>A Garden of Cats</i>), lists ways of
									describing the physical appearance of cats. A cat with a
									pure-colored coat of any color was "Good All Year Round"
									(四時好). "Dark Clouds Over Snow" (烏雲蓋雪) was a black cat
									with white fur on its belly and paws — but if only the paws
									were white, it was "Walking Through Snow in Search of Plums"
									(踏雪尋梅).
								</p>

								<p>
									The Song-dynasty poet and ailurophile Lu You 陸游 names three
									cats in his poems — "Pink-nose" (粉鼻), "Snowball" (雪兒), and
									"Tigger" (小於菟, from <i>wūtú</i>, a literary word for
									"tiger" borrowed from the extinct Chu language).
								</p>
							</div>
						</article>
					</main>
				</div>
			</div>
		</div>

		<script>
			const preview = document.getElementById("preview");
			const MOBILE_BREAKPOINT = 900;

			function isMobile() {
				return window.innerWidth <= MOBILE_BREAKPOINT;
			}

			// Margin notes alignment - matches base.njk implementation
			function alignMarginNotes() {
				if (preview.classList.contains("playground-no-notes")) return;
				if (isMobile()) {
					document.querySelectorAll(".mn-note").forEach((note) => {
						note.style.position = "";
						note.style.top = "";
						note.hidden = true;
					});
					return;
				}

				const postBody = document.querySelector(".post-body");
				if (!postBody) return;

				const bodyRect = postBody.getBoundingClientRect();
				const bodyScrollTop = bodyRect.top + window.scrollY;

				document.querySelectorAll(".mn-marker").forEach((marker) => {
					const noteId = marker.getAttribute("data-mn-id");
					if (!noteId) return;

					const note = document.getElementById(noteId);
					if (!note) return;

					// Move note to be a direct child of post-body
					if (note.parentElement !== postBody) {
						postBody.appendChild(note);
					}

					const markerRect = marker.getBoundingClientRect();
					const markerTop = markerRect.top + window.scrollY;
					const offsetFromBodyTop = markerTop - bodyScrollTop;

					note.style.position = "absolute";
					note.style.top = offsetFromBodyTop + "px";
					note.removeAttribute("hidden");
				});
			}

			// Mobile toggle - matches base.njk implementation
			function handleMarkerClick(e) {
				if (!isMobile()) return;

				const marker = e.currentTarget;
				const noteId = marker.getAttribute("data-mn-id");
				if (!noteId) return;

				const note = document.getElementById(noteId);
				if (!note) return;

				e.preventDefault();

				const isHidden = note.hasAttribute("hidden");
				if (isHidden) {
					note.removeAttribute("hidden");
					note.classList.add("is-visible");
					marker.setAttribute("aria-expanded", "true");
				} else {
					note.setAttribute("hidden", "");
					note.classList.remove("is-visible");
					marker.setAttribute("aria-expanded", "false");
				}
			}

			function wireToggles() {
				document.querySelectorAll(".mn-marker").forEach((marker) => {
					marker.addEventListener("click", handleMarkerClick);
				});
			}

			function scheduleAlign() {
				requestAnimationFrame(alignMarginNotes);
			}

			function updatePreview() {
				const values = {
					paper: document.getElementById("paper").value,
					paper2: document.getElementById("paper2").value,
					ink: document.getElementById("ink").value,
					ink2: document.getElementById("ink2").value,
					vermillion: document.getElementById("vermillion").value,
					rule: document.getElementById("rule").value,
					textSize: document.getElementById("textSize").value,
					leading: document.getElementById("leading").value,
					bodyWeight: document.getElementById("bodyWeight").value,
					postBodySize: document.getElementById("postBodySize").value,
					postBodyLeading: document.getElementById("postBodyLeading").value,
					titleSize: document.getElementById("titleSize").value,
					titleLeading: document.getElementById("titleLeading").value,
					titleWeight: document.getElementById("titleWeight").value,
					mnSize: document.getElementById("mnSize").value,
					mnLeading: document.getElementById("mnLeading").value,
					postMeasure: document.getElementById("postMeasure").value,
					mnWidth: document.getElementById("mnWidth").value,
					mnGap: document.getElementById("mnGap").value,
					measure: document.getElementById("measure").value,
					showMarginNotes: document.getElementById("showMarginNotes").checked,
				};

				// Apply CSS variables
				preview.style.setProperty("--paper", values.paper);
				preview.style.setProperty("--paper-2", values.paper2);
				preview.style.setProperty("--ink", values.ink);
				preview.style.setProperty("--ink-2", values.ink2);
				preview.style.setProperty("--vermillion", values.vermillion);
				preview.style.setProperty("--rule", values.rule);
				preview.style.setProperty("--text-size", values.textSize + "rem");
				preview.style.setProperty("--leading", values.leading);
				preview.style.fontWeight = values.bodyWeight;

				// Post body overrides
				const postBody = document.querySelector(".post-body");
				if (postBody) {
					postBody.style.fontSize = values.postBodySize + "rem";
					postBody.style.lineHeight = values.postBodyLeading;
				}

				// Title overrides
				const postTitle = document.querySelector(".post-title");
				if (postTitle) {
					postTitle.style.fontSize = `clamp(1.8rem, 4vw, ${values.titleSize}rem)`;
					postTitle.style.lineHeight = values.titleLeading;
					postTitle.style.fontWeight = values.titleWeight;
				}

				// Margin notes overrides
				document.querySelectorAll(".mn-note").forEach((note) => {
					note.style.fontSize = values.mnSize + "rem";
					note.style.lineHeight = values.mnLeading;
				});

				// Layout variables on .post
				const post = document.querySelector(".post");
				if (post) {
					post.style.setProperty("--post-measure", values.postMeasure + "ch");
					post.style.setProperty("--mn-width", values.mnWidth + "px");
					post.style.setProperty("--mn-gap", values.mnGap + "rem");
				}

				// Global measure
				preview.style.setProperty("--measure", values.measure + "ch");

				// Toggle margin notes visibility
				preview.classList.toggle(
					"playground-no-notes",
					!values.showMarginNotes,
				);

				// Update displayed values
				document.getElementById("textSizeVal").textContent =
					values.textSize + "rem";
				document.getElementById("leadingVal").textContent = values.leading;
				document.getElementById("bodyWeightVal").textContent =
					values.bodyWeight;
				document.getElementById("postBodySizeVal").textContent =
					values.postBodySize + "rem";
				document.getElementById("postBodyLeadingVal").textContent =
					values.postBodyLeading;
				document.getElementById("titleSizeVal").textContent =
					values.titleSize + "rem";
				document.getElementById("titleLeadingVal").textContent =
					values.titleLeading;
				document.getElementById("titleWeightVal").textContent =
					values.titleWeight;
				document.getElementById("mnSizeVal").textContent =
					values.mnSize + "rem";
				document.getElementById("mnLeadingVal").textContent = values.mnLeading;
				document.getElementById("postMeasureVal").textContent =
					values.postMeasure + "ch";
				document.getElementById("mnWidthVal").textContent =
					values.mnWidth + "px";
				document.getElementById("mnGapVal").textContent = values.mnGap + "rem";
				document.getElementById("measureVal").textContent =
					values.measure + "ch";

				scheduleAlign();
			}

			function copyCSS() {
				const css = `/* Colors */
--paper: ${document.getElementById("paper").value};
--paper-2: ${document.getElementById("paper2").value};
--ink: ${document.getElementById("ink").value};
--ink-2: ${document.getElementById("ink2").value};
--vermillion: ${document.getElementById("vermillion").value};
--rule: ${document.getElementById("rule").value};

/* Base Typography */
--text-size: ${document.getElementById("textSize").value}rem;
--leading: ${document.getElementById("leading").value};
body { font-weight: ${document.getElementById("bodyWeight").value}; }

/* .post-body */
.post-body {
  font-size: ${document.getElementById("postBodySize").value}rem;
  line-height: ${document.getElementById("postBodyLeading").value};
}

/* .post-title */
.post-title {
  font-size: clamp(1.8rem, 4vw, ${document.getElementById("titleSize").value}rem);
  line-height: ${document.getElementById("titleLeading").value};
  font-weight: ${document.getElementById("titleWeight").value};
}

/* .mn-note */
.mn-note {
  font-size: ${document.getElementById("mnSize").value}rem;
  line-height: ${document.getElementById("mnLeading").value};
}

/* .post layout variables */
.post {
  --post-measure: ${document.getElementById("postMeasure").value}ch;
  --mn-width: ${document.getElementById("mnWidth").value}px;
  --mn-gap: ${document.getElementById("mnGap").value}rem;
}

/* Global */
--measure: ${document.getElementById("measure").value}ch;`;

				navigator.clipboard.writeText(css).then(() => {
					alert("CSS copied to clipboard!");
				});
			}

			// Event listeners
			let resizeTimeout;
			window.addEventListener("resize", () => {
				clearTimeout(resizeTimeout);
				resizeTimeout = setTimeout(scheduleAlign, 100);
			});

			document.querySelectorAll("input, select").forEach((el) => {
				el.addEventListener("input", updatePreview);
			});

			// Initialize
			wireToggles();
			window.addEventListener("load", scheduleAlign);

			if (document.fonts && document.fonts.ready) {
				document.fonts.ready.then(() => {
					setTimeout(scheduleAlign, 150);
				});
			}

			updatePreview();
		</script>
	</body>
</html>

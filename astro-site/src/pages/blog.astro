---
/**
 * Blog Archive Page
 *
 * Displays all published posts in reverse chronological order
 */

import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

const posts = await getCollection('blog');

// Sort by date, newest first
const sortedPosts = posts.sort((a, b) =>
  b.data.date.valueOf() - a.data.date.valueOf()
);
---

<BaseLayout title="Archive - Burning House">
  <main class="site-main">
    <div class="site-main-inner">
      <article class="post-body">
        <h1>Archive</h1>

        <div class="archive-list">
          {sortedPosts.map((post) => {
            const date = post.data.date.toLocaleDateString('en-US', {
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            });

            return (
              <article class="archive-item">
                <h2>
                  <a href={`/${post.slug}`}>{post.data.title}</a>
                </h2>
                {post.data.subtitle && (
                  <p class="archive-subtitle">{post.data.subtitle}</p>
                )}
                <time datetime={post.data.date.toISOString()}>{date}</time>
                {post.data.description && (
                  <p class="archive-description">{post.data.description}</p>
                )}
              </article>
            );
          })}
        </div>
      </article>
    </div>
  </main>
</BaseLayout>

<style>
  .archive-list {
    margin-top: var(--space-xl, 3rem);
  }

  .archive-item {
    margin-bottom: var(--space-xl, 3rem);
    padding-bottom: var(--space-lg, 2rem);
    border-bottom: 1px solid var(--rule, #ddd);
  }

  .archive-item:last-child {
    border-bottom: none;
  }

  .archive-item h2 {
    margin-bottom: var(--space-xs, 0.5rem);
  }

  .archive-item h2 a {
    color: var(--ink, #241425);
    text-decoration: none;
  }

  .archive-item h2 a:hover {
    color: var(--vermillion, #8f1d14);
  }

  .archive-subtitle {
    font-family: var(--font-display);
    font-style: italic;
    margin-bottom: var(--space-sm, 1rem);
    color: var(--ink-2, #3a223a);
  }

  .archive-item time {
    font-family: var(--font-display);
    font-size: 0.9rem;
    color: var(--ink-2, #3a223a);
    display: block;
    margin-bottom: var(--space-sm, 1rem);
  }

  .archive-description {
    color: var(--ink-2, #3a223a);
    margin-top: var(--space-sm, 1rem);
  }
</style>

---
layout: layouts/base.njk
---
{# Syntax highlighting for code blocks #}
<style>{% include "node_modules/prismjs/themes/prism-okaidia.css" %}</style>
<style>{% include "css/prism-diff.css" %}</style>

<article class="post" data-pagefind-body>
	{# Pagefind metadata for search #}
	{% if post_image_thumb or post_image %}
		<span class="pagefind-meta" data-pagefind-meta="image">{{ post_image_thumb or post_image }}</span>
	{% endif %}
	{% if post_image_alt or postImageAlt %}
		<span class="pagefind-meta" data-pagefind-meta="image_alt">{{ post_image_alt or postImageAlt }}</span>
	{% endif %}
	{% if summary %}
		<span class="pagefind-meta" data-pagefind-meta="summary">{{ summary }}</span>
	{% endif %}

	<header class="post-header">
		<h1 class="post-title" data-pagefind-meta="title">{{ title }}</h1>
		<ul class="post-metadata" data-pagefind-ignore>
			<li><time datetime="{{ page.date | htmlDateString }}" data-pagefind-meta="date">{{ page.date | readableDate }}</time></li>
			{%- if tags %}
			{%- for tag in tags | filterTagList %}
			{%- set tagUrl %}/tags/{{ tag | slugify }}/{% endset %}
			<li><a href="{{ tagUrl }}" class="post-tag">{{ tag }}</a>{%- if not loop.last %}, {% endif %}</li>
			{%- endfor %}
			{%- endif %}
		</ul>
	</header>

	{# Strip leading H1 #}
	{% set cleanContent = content | stripLeadingH1 %}
	<div class="post-body">
		{{ cleanContent | safe }}
	</div>

	{# Footnotes are stored in page._footnotes by the {% fn %} shortcode #}
	{%- if page._footnotes and page._footnotes.length %}
	<section class="footnotes">
		<hr class="footnotes-separator">
		<h2 class="footnotes-title" id="notes">Notes</h2>
		<ol class="footnotes-list">
			{%- for note in page._footnotes %}
			<li id="{{ note.id }}">{{ note.content | safe }} <a href="#{{ note.refId }}" class="footnote-backref" aria-label="Back to content">↩</a></li>
			{%- endfor %}
		</ol>
	</section>
	{%- endif %}

	{%- if collections.posts %}
	{%- set previousPost = collections.posts | getPreviousCollectionItem %}
	{%- set nextPost = collections.posts | getNextCollectionItem %}
	{%- if nextPost or previousPost %}
	<nav class="post-nav" aria-label="Post navigation">
		<ul class="links-nextprev">
			{%- if previousPost %}<li class="links-nextprev-prev"><a href="{{ previousPost.url }}">← {{ previousPost.data.title }}</a></li>{% endif %}
			{%- if nextPost %}<li class="links-nextprev-next"><a href="{{ nextPost.url }}">{{ nextPost.data.title }} →</a></li>{% endif %}
		</ul>
	</nav>
	{%- endif %}
	{%- endif %}
</article>
